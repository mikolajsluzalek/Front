@page "/formularz-pracowniczy"
@inject IDialogService DialogService
@using MudBlazor.Components
@using MudBlazor

<MudContainer MaxWidth="MaxWidth.Medium">
<MudCard>
    <MudCardContent>
        <MudText Typo="Typo.h5">Formularz Pracownika</MudText>
        <MudForm @ref="form" OnValidSubmit="HandleValidSubmit">
            <MudText Typo="Typo.h6" Class="mt-4">Dane Podstawowe</MudText>
            <MudGrid>
                <MudItem xs="12" md="6">
                    <MudTextField @bind-Value="employee.LastName" Label="Nazwisko" Required />
                 </MudItem>
                 <MudItem xs="12" md="6">
                     <MudTextField @bind-Value="employee.FirstName" Label="Imię" Required />
                 </MudItem>
                 <MudItem xs="12" md="6">
                     <MudTextField @bind-Value="employee.PESEL" Label="PESEL" Required />
                 </MudItem>
                 <MudItem xs="12" md="6">
                     <MudTextField @bind-Value="employee.PassportNumber" Label="Numer Paszportu" />
                 </MudItem>
                 <MudItem xs="12" md="6">
                     <MudDatePicker @bind-Date="employee.BirthDate" Label="Data Urodzenia" />
                 </MudItem>
                 <MudItem xs="12" md="6">
                     <MudTextField @bind-Value="employee.Email" Label="Email" Type="email" />
                 </MudItem>
                 <MudItem xs="12" md="6">
                     <MudTextField @bind-Value="employee.PhoneNumber" Label="Numer Telefonu" />
                 </MudItem>
                 <MudItem xs="12" md="6">
                     <MudTextField @bind-Value="employee.Address" Label="Adres Zamieszkania" />
                 </MudItem>
             </MudGrid>

             <!-- Karta Profilu -->
             <MudText Typo="Typo.h6" Class="mt-4">Karta Profilu</MudText>
             <MudGrid>
                 <MudItem xs="12" md="6">
                         <MudSelect T="string" Label="Wybierz opcję" @bind-Value="SelectedOption">
                             <MudSelectItem Value="@("Wiza")">Wiza</MudSelectItem>
                             <MudSelectItem Value="@("Karta")">Karta</MudSelectItem>
                             <MudSelectItem Value="@("Bio")">Bio</MudSelectItem>
                         </MudSelect>
                 </MudItem>
                 <MudItem xs="12" md="6">
                     <MudDatePicker @bind-Date="profile.ValidUntil" Label="Ważność" />
                 </MudItem>
             </MudGrid>

             <!-- Zatrudnienie -->
             <MudText Typo="Typo.h6" Class="mt-4">Zatrudnienie</MudText>
             <MudGrid>
                 <MudItem xs="12" md="6">
                     <MudTextField @bind-Value="employment.ContractType" Label="Rodzaj Umowy" Required />
                 </MudItem>
                 <MudItem xs="12" md="6">
                     <MudDatePicker @bind-Date="employment.DateFrom" Label="Data Od" Required />
                 </MudItem>
                 <MudItem xs="12" md="6">
                     <MudDatePicker @bind-Date="employment.DateTo" Label="Data Do" />
                 </MudItem>
                 <MudItem xs="12" md="12">
                     <MudTextField @bind-Value="employment.Permissions" Label="Uprawnienia" />
                 </MudItem>
             </MudGrid>

             <!-- Badania -->
             <MudText Typo="Typo.h6" Class="mt-4">Badania</MudText>
             <MudGrid>
                 <MudItem xs="12" md="6">
                     <MudDatePicker @bind-Date="tests.BHP_ValidUntil" Label="BHP Ważne Do" />
                 </MudItem>
                 <MudItem xs="12" md="6">
                     <MudDatePicker @bind-Date="tests.PsychologicalTest_ValidUntil" Label="Psychotesty Ważne Do" />
                 </MudItem>
                 <MudItem xs="12" md="6">
                     <MudDatePicker @bind-Date="tests.MedicalTest_ValidUntil" Label="Badania Lekarskie Ważne Do" />
                 </MudItem>
                 <MudItem xs="12" md="6">
                     <MudDatePicker @bind-Date="tests.SanitaryTest_ValidUntil" Label="Sanepid Ważne Do" />
                 </MudItem>
             </MudGrid>

             <!-- Przyciski -->
             <MudCardActions>
                 <MudSpacer />
                 <MudButton Type="submit" Variant="Variant.Filled" Color="Color.Primary">Zapisz</MudButton>
                     <MudButton @onclick="OpenDialogAsync" Variant="Variant.Filled" Color="Color.Primary">
                         Anuluj
                     </MudButton>
                 </MudCardActions>
         </MudForm>
     </MudCardContent>
 </MudCard>
 </MudContainer>

 @code {
    private MudForm form;
    private Employee employee = new Employee();
    private Profile profile = new Profile();
    private Employment employment = new Employment();
    private Tests tests = new Tests();

    private string SelectedOption { get; set; } = "";


    private void HandleValidSubmit()
    {
        // Logika zapisu formularza
    }

    private void Cancel()
    {
        // Logika anulowania
    }

    public class Employee
    {
        public string FirstName { get; set; }
        public string LastName { get; set; }
        public string PassportNumber { get; set; }
        public string PESEL { get; set; }
        public DateTime? BirthDate { get; set; }
        public string Email { get; set; }
        public string PhoneNumber { get; set; }
        public string Address { get; set; }
    }

    public class Profile
    {
        public string Card { get; set; }
        public DateTime? ValidUntil { get; set; }
    }

    public class Employment
    {
        public string ContractType { get; set; }
        public DateTime? DateFrom { get; set; }
        public DateTime? DateTo { get; set; }
        public string Permissions { get; set; }
    }

    public class Tests
    {
        public DateTime? BHP_ValidUntil { get; set; }
        public DateTime? PsychologicalTest_ValidUntil { get; set; }
        public DateTime? MedicalTest_ValidUntil { get; set; }
        public DateTime? SanitaryTest_ValidUntil { get; set; }
    }

    private Task OpenDialogAsync()
    {
        var options = new DialogOptions { CloseOnEscapeKey = true };

        return DialogService.ShowAsync<DeclineDialog>("Simple Dialog", options);
    }
}
